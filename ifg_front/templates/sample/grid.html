{% extends 'common/sampleBase.html' %}

{% block content %}
    <script type="text/javascript">
        $(document).ready(function(){
            var API_SERVER = "http://api-demo.ax5.io";
            var firstGrid = new ax5.ui.grid({
                target: $('[data-ax5grid="first-grid"]'),
                columns: [
                    {
                        key: "a",
                        label: "field A",
                        width: 80,
                        styleClass: function () {
                            return "ABC";
                        },
                        enableFilter: true,
                        align: "center", editor: {type: "text"}
                    },
                    {key: "b", label: "field  B", align: "center", editor: {type: "text"}},
                    {
                        key: undefined,
                        label: "field C",
                        columns: [
                            {key: "price", label: "price", formatter: "money", align: "right", editor: {type: "money", updateWith:['cost']}},
                            {key: "amount", label: "amount", formatter: "money", align: "right", editor: {type: "money", updateWith:['cost']}},
                            {
                                key: "cost",
                                label: "cost",
                                align: "right",
                                formatter: function () {
                                    return ax5.util.number(this.item.price * this.item.amount, {"money": true});
                                }
                            }
                        ]
                    },
                    {
                        key: "saleDt",
                        label: "saleDt",
                        //formatter: "date",
                        align: "center",
                        editor: {
                            type: "date",
                            config: {
                                content: {
                                    config: {
                                        mode: "day", selectMode: "day"
                                    }
                                }
                            }
                        }
                    },
                    {key: "customer", label: "customer", editor: {type: "text"}},
                    {
                        key: "userType",
                        label: "userType",
                        editor: {
                            type: "select",
                            config: {
                                columnKeys: {
                                    optionValue: "CD", optionText: "NM"
                                },
                                options: [
                                    {CD: "M", NM: "M: Man"},
                                    {CD: "D", NM: "D: Daughter"},
                                    {CD: "S", NM: "S: Son"},
                                    {CD: "W", NM: "W: Wife"}
                                ]
                            }
                        }
                    },
                    {key: "desc", label: "desc", width:400, editor: {type: "textarea"}}
                ],
                body: {
                    grouping: {
                        by: ["a"],
                        columns: [
                            {
                                label: function () {
                                    return this.groupBy.labels.join(", ") + " SUM";
                                },
                                colspan: 2,
                                align: "center"
                            },
                            {key: "price", collector: "avg", formatter: "money", align: "right"},
                            {key: "amount", collector: "sum", formatter: "money", align: "right"},
                            {
                                key: "cost",
                                collector: function () {
                                    var value = 0;
                                    this.list.forEach(function (n) {
                                        if (!n.__isGrouping) value += (n.price * n.amount);
                                    });
                                    return ax5.util.number(value, {"money": 1});
                                },
                                align: "right"
                            }
                        ]
                    }
                },
                footSum: [
                    [
                        {label: "SUMMARY", colspan: 2, align: "center"},
                        {key: "price", collector: "avg", formatter: "money", align: "right"},
                        {key: "amount", collector: "sum", formatter: "money", align: "right"},
                        {
                            key: "cost",
                            collector: function () {
                                var value = 0;
                                this.list.forEach(function (n) {
                                    if (!n.__isGrouping) value += (n.price * n.amount);
                                });
                                return ax5.util.number(value, {"money": 1});
                            },
                            align: "right"
                        }
                    ]]
            });

            var gridList = [
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"M", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"M", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"A", "b":"A01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"W", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"W", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"W", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"M", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""},
                {"a":"B", "b":"B01", "price":"1000", "amount":"10", "cost":"12100", "saleDt":"20200312", "customer":"lee", "userType":"D", "desc":""}
            ];

            firstGrid.setData(gridList);

        });
    </script>
    <style>
        .row { margin-bottom: 10px; }
        [class|="col"] {
          font-weight: 700;
          padding: 10px;
        }
    </style>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h3>Grid <a href="http://ax5.io/ax5ui-grid/api/index.html" class="badge badge-info">Info</a></h3>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                    <div style="position: relative;height:400px;" id="grid-parent">
                        <div data-ax5grid="first-grid" data-ax5grid-config="{frozenColumnIndex: 2,showLineNumber: true,showRowSelector: true,sortable: true,header: {align:'center'}}" style="height: 100%;"></div>
                    </div>
            </div>


        </div>




    </div>
{% endblock %}